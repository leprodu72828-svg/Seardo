<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Seardo</title>
<style>
:root {
  --bg:#020617;
  --panel:#020617;
  --border:#38bdf8;
  --accent:#38bdf8;
}

body {
  margin:0;
  font-family:system-ui, Arial;
  background:var(--bg);
  color:white;
}

.hidden { display:none; }

.container {
  max-width:420px;
  margin:80px auto;
  background:var(--panel);
  padding:25px;
  border-radius:14px;
  border:1px solid var(--border);
  box-shadow:0 0 30px #000;
}

h1,h2,h3 { text-align:center; }

input {
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:1px solid var(--border);
  background:#020617;
  color:white;
}

button {
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:8px;
  border:none;
  background:var(--accent);
  font-weight:bold;
  cursor:pointer;
}

button:hover { opacity:.85; }

header {
  padding:25px;
  text-align:center;
}

.filters label {
  margin:0 10px;
}

.results {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
  gap:15px;
  padding:20px;
}

.card {
  border:1px solid var(--border);
  border-radius:10px;
  padding:15px;
}

a { color:var(--accent); }
.admin { border-color:red; }
</style>
</head>
<body>

<!-- AUTH -->
<div class="container" id="auth">
  <h1>Seardo</h1>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button onclick="login()">Login</button>
  <button onclick="register()">Create account</button>
</div>

<!-- DASHBOARD -->
<div id="app" class="hidden">
<header>
  <h1>üîç Seardo Search</h1>
  <input id="query" placeholder="Search anything...">
  <br><br>
  <button onclick="search()">Search</button>
  <p id="role"></p>
  <button onclick="logout()">Logout</button>
</header>

<div class="filters">
  <label><input type="checkbox" id="wiki" checked> Wiki</label>
  <label><input type="checkbox" id="news" checked> News</label>
  <label><input type="checkbox" id="movies" checked> Movies</label>
  <label><input type="checkbox" id="music" checked> Music</label>
  <label><input type="checkbox" id="books" checked> Books</label>
</div>

<div class="results" id="results"></div>

<!-- ADMIN PANEL -->
<div class="container admin hidden" id="adminPanel">
  <h2>Admin Panel</h2>
  <p>Total users: <span id="userCount"></span></p>
  <p>You can enable / disable APIs using the filters above.</p>
</div>
</div>

<script>
/* ===== USERS ===== */
function users() {
  return JSON.parse(localStorage.getItem("users") || "[]");
}
function saveUsers(u) {
  localStorage.setItem("users", JSON.stringify(u));
}

/* ===== AUTH ===== */
function register() {
  const e = email.value;
  const p = password.value;
  if (!e || !p) return alert("Missing fields");

  let u = users();
  if (u.find(x=>x.email===e)) return alert("Account exists");

  const role = u.length === 0 ? "admin" : "user";
  u.push({email:e,password:p,role});
  saveUsers(u);

  alert("Account created ("+role+")");
}

function login() {
  const u = users().find(x=>x.email===email.value && x.password===password.value);
  if (!u) return alert("Invalid login");

  localStorage.setItem("session", JSON.stringify(u));
  loadApp();
}

function logout() {
  localStorage.removeItem("session");
  location.reload();
}

function loadApp() {
  const s = JSON.parse(localStorage.getItem("session"));
  if (!s) return;

  auth.classList.add("hidden");
  app.classList.remove("hidden");
  role.textContent = "Role: " + s.role.toUpperCase();

  if (s.role === "admin") {
    adminPanel.classList.remove("hidden");
    userCount.textContent = users().length;
  }
}

loadApp();

/* ===== SEARCH ===== */
const results = document.getElementById("results");

function card(t,c,l){
  return `<div class="card"><h3>${t}</h3><p>${c||""}</p>${l?`<a href="${l}" target="_blank">Open</a>`:""}</div>`;
}

async function search() {
  results.innerHTML="";
  const q=query.value;
  if(!q) return;

  if(wiki.checked){
    const r=await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${q}`);
    if(r.ok){
      const d=await r.json();
      results.innerHTML+=card("Wikipedia",d.extract,d.content_urls?.desktop?.page);
    }
  }

  if(news.checked){
    const r=await fetch(`https://hn.algolia.com/api/v1/search?query=${q}`);
    const d=await r.json();
    d.hits.slice(0,3).forEach(n=>{
      results.innerHTML+=card("News",n.title,n.url);
    });
  }

  if(movies.checked){
    const r=await fetch(`https://api.tvmaze.com/search/shows?q=${q}`);
    const d=await r.json();
    d.slice(0,3).forEach(m=>{
      results.innerHTML+=card("Movie",m.show.name,m.show.summary?.replace(/<[^>]+>/g,""),m.show.url);
    });
  }

  if(music.checked){
    const r=await fetch(`https://itunes.apple.com/search?term=${q}&limit=3`);
    const d=await r.json();
    d.results.forEach(m=>{
      results.innerHTML+=card("Music",m.trackName,m.artistName,m.trackViewUrl);
    });
  }

  if(books.checked){
    const r=await fetch(`https://openlibrary.org/search.json?q=${q}`);
    const d=await r.json();
    d.docs.slice(0,3).forEach(b=>{
      results.innerHTML+=card("Book",b.title,`Author: ${b.author_name?.[0]||""}`,`https://openlibrary.org${b.key}`);
    });
  }
}
</script>

</body>
</html>
